# 环境配置说明

## 问题解决：硬编码地址

### 修复前的问题
项目中存在大量硬编码的地址：
- `http://localhost:3004` - 后端服务地址
- `http://localhost:11434` - Ollama AI 服务地址  
- `https://probe.yeepay.com` - Probe API 地址

### 修复方案

#### 1. 创建统一的环境配置管理
- 新增 `src/config/environment.js` 文件
- 支持环境变量配置
- 支持开发/生产环境切换

#### 2. 环境变量配置
创建 `.env.development` 文件：
```bash
# 后端服务地址
VITE_BACKEND_URL=http://localhost:3004

# Ollama AI 服务地址
VITE_OLLAMA_URL=http://localhost:11434

# Probe API 地址
VITE_PROBE_URL=https://probe.yeepay.com
```

#### 3. 已修复的文件
- ✅ `src/services/configSyncService.js` - 后端API调用
- ✅ `src/services/backendService.js` - 后端服务配置
- ✅ `src/store/index.js` - Ollama配置
- ✅ `src/api/probeService.js` - Probe API配置

#### 4. 使用方法

##### 在代码中使用配置
```javascript
import { getBackendConfig, buildApiUrl } from '@/config/environment'

// 获取后端配置
const config = getBackendConfig()
console.log(config.baseUrl) // http://localhost:3004

// 构建API URL
const healthUrl = buildApiUrl('/api/health')
console.log(healthUrl) // http://localhost:3004/api/health
```

##### 通过环境变量覆盖
```bash
# 开发环境
VITE_BACKEND_URL=http://localhost:3004

# 生产环境
VITE_BACKEND_URL=https://api.yourdomain.com
```

#### 5. 配置优先级
1. 环境变量 (`VITE_*`)
2. 默认配置值
3. 硬编码值（已移除）

### 剩余需要修复的文件
以下文件仍包含硬编码地址，需要进一步修复：
- `src/components/settings/ProjectConfigTab.vue`
- `src/utils/configForceSync.js`
- `src/utils/configSyncChecker.js`
- `src/components/CacheManagementPanel.vue`
- `src/components/settings/PageMenuTab.vue`
- `src/components/settings/ApiConfigTab.vue`
- `src/components/settings/AiConfigTab.vue`
- `src/components/ConfigModal.vue`
- `src/utils/databaseDebugger.js`
- `src/utils/ollamaService.js`

### 下一步计划
1. 修复剩余文件中的硬编码地址
2. 创建环境变量配置文件
3. 添加配置验证和错误处理
4. 更新部署文档

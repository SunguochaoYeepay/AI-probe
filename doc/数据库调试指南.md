# æ•°æ®åº“è°ƒè¯•æŒ‡å—

## ğŸ¯ é—®é¢˜è§£å†³

æ‚¨æå‡ºçš„"åŒæ•°æ®åº“å¯¼è‡´è°ƒè¯•å›°éš¾"é—®é¢˜å·²ç»è§£å†³ï¼

## âœ… è§£å†³æ–¹æ¡ˆ

### 1. ç»Ÿä¸€æ•°æ®åº“ç­–ç•¥
```
å¼€å‘ç¯å¢ƒ: SQLite (localhost:3004)
ç”Ÿäº§ç¯å¢ƒ: SQLite (Electron)
```

**ä¸å†ä½¿ç”¨IndexedDB**ï¼Œæ‰€æœ‰ç¯å¢ƒéƒ½ä½¿ç”¨SQLiteï¼

### 2. æ–°çš„å¯åŠ¨æ–¹å¼

```bash
# å¼€å‘ç¯å¢ƒï¼šåŒæ—¶å¯åŠ¨å‰åç«¯
npm run dev

# æˆ–è€…åˆ†åˆ«å¯åŠ¨
npm run dev:frontend  # åªå¯åŠ¨å‰ç«¯
npm run dev:backend   # åªå¯åŠ¨åç«¯
```

### 3. æ•°æ®åº“è°ƒè¯•å·¥å…·

åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­ä½¿ç”¨ï¼š

```javascript
// æ£€æŸ¥å½“å‰æ•°æ®åº“
databaseDebugger.checkConnection()

// è·å–æ•°æ®åº“ç»Ÿè®¡
databaseDebugger.getStats()

// æ¸…ç†æ•°æ®åº“
databaseDebugger.clearDatabase()

// å¯¼å‡ºè°ƒè¯•ä¿¡æ¯
databaseDebugger.exportDebugInfo()
```

## ğŸ”§ è°ƒè¯•æŠ€å·§

### 1. æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ
const info = await databaseDebugger.exportDebugInfo()
console.log('æ•°æ®åº“ä¿¡æ¯:', info)
```

### 2. ç›‘æ§APIè¯·æ±‚
```javascript
// æŸ¥çœ‹åç«¯APIç»Ÿè®¡
fetch('http://localhost:3004/api/stats')
  .then(r => r.json())
  .then(console.log)
```

### 3. æ¸…ç†æµ‹è¯•æ•°æ®
```javascript
// æ¸…ç†æ‰€æœ‰æ•°æ®
await databaseDebugger.clearDatabase()
```

## ğŸ“Š æ•°æ®åº“ç»“æ„

### SQLiteè¡¨ç»“æ„
```sql
-- å›¾è¡¨é…ç½®è¡¨
charts (id, name, config, chart_type, created_at, updated_at)

-- èšåˆæ•°æ®è¡¨  
chart_data (id, chart_id, date, data, created_at)

-- åŸå§‹æ•°æ®ç¼“å­˜è¡¨
raw_data_cache (id, bury_point_id, date, data, created_at)
```

### ç´¢å¼•ä¼˜åŒ–
```sql
-- æ€§èƒ½ç´¢å¼•
CREATE INDEX idx_chart_data_chart_id ON chart_data(chart_id);
CREATE INDEX idx_chart_data_date ON chart_data(date);
CREATE INDEX idx_raw_data_cache_bury_point_id ON raw_data_cache(bury_point_id);
```

## ğŸš€ æ€§èƒ½ä¼˜åŠ¿

| ç‰¹æ€§ | ä¹‹å‰(åŒæ•°æ®åº“) | ç°åœ¨(ç»Ÿä¸€SQLite) |
|------|---------------|------------------|
| è°ƒè¯•éš¾åº¦ | å›°éš¾ | ç®€å• |
| æ•°æ®ä¸€è‡´æ€§ | ä¸ä¸€è‡´ | å®Œå…¨ä¸€è‡´ |
| æŸ¥è¯¢è¯­æ³• | ä¸¤å¥— | ç»Ÿä¸€SQL |
| é”™è¯¯å®šä½ | å¤æ‚ | ç®€å• |
| æµ‹è¯•è¦†ç›– | ä¸¤å¥— | ä¸€å¥— |

## ğŸ› ï¸ å¼€å‘æµç¨‹

### æ—¥å¸¸å¼€å‘
```bash
npm run dev  # ä¸€é”®å¯åŠ¨å‰åç«¯
```

### è°ƒè¯•é—®é¢˜
1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°
2. è¿è¡Œ `databaseDebugger.checkConnection()`
3. æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯
4. ä½¿ç”¨SQLæŸ¥è¯¢å®šä½é—®é¢˜

### æ€§èƒ½æµ‹è¯•
```bash
# æµ‹è¯•åç«¯API
curl http://localhost:3004/api/stats

# æµ‹è¯•æ•°æ®èšåˆ
curl -X POST http://localhost:3004/api/aggregate \
  -H "Content-Type: application/json" \
  -d '{"rawData": [...], "chartConfig": {...}}'
```

## ğŸ‰ æ€»ç»“

ç°åœ¨æ‚¨åªéœ€è¦ï¼š
1. **ä¸€ä¸ªæ•°æ®åº“**ï¼šSQLite
2. **ä¸€å¥—æŸ¥è¯¢è¯­æ³•**ï¼šSQL
3. **ä¸€ä¸ªè°ƒè¯•å·¥å…·**ï¼šdatabaseDebugger
4. **ä¸€è‡´çš„å¼€å‘ä½“éªŒ**ï¼šå¼€å‘å’Œç”Ÿäº§ç¯å¢ƒå®Œå…¨ç›¸åŒ

è°ƒè¯•é—®é¢˜å˜å¾—ç®€å•å¤šäº†ï¼ğŸ¯

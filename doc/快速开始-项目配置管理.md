# é¡¹ç›®é…ç½®ç®¡ç† - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å¿«é€Ÿä¸Šæ‰‹ä½¿ç”¨æ–°å¢çš„é¡¹ç›®é…ç½®ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å›¢é˜Ÿåˆ—è¡¨è·å–å’Œé¡¹ç›®ç‚¹ä½ç®¡ç†ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨é¡¹ç›®

```bash
# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### 2. è®¿é—®é…ç½®ç®¡ç†é¡µé¢

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š
```
http://localhost:5173/project-config
```

### 3. ä½¿ç”¨ç•Œé¢æ“ä½œ

#### è·å–å›¢é˜Ÿåˆ—è¡¨
1. ç‚¹å‡» "è·å–å›¢é˜Ÿåˆ—è¡¨" æŒ‰é’®
2. ç³»ç»Ÿå°†è‡ªåŠ¨æ˜¾ç¤ºæ‰€æœ‰å›¢é˜Ÿä¿¡æ¯
3. å¯ä»¥æŸ¥çœ‹å›¢é˜Ÿåç§°ã€IDç­‰è¯¦ç»†ä¿¡æ¯

#### è·å–é¡¹ç›®ç‚¹ä½
1. ç‚¹å‡» "è·å–é¡¹ç›®ç‚¹ä½" æŒ‰é’®
2. ç³»ç»Ÿå°†åŠ è½½å½“å‰é¡¹ç›®çš„æ‰€æœ‰åŸ‹ç‚¹é…ç½®
3. æ”¯æŒæœç´¢åŠŸèƒ½ï¼Œå¿«é€ŸæŸ¥æ‰¾ç‰¹å®šç‚¹ä½

#### åˆ·æ–°æ‰€æœ‰æ•°æ®
ç‚¹å‡» "åˆ·æ–°æ‰€æœ‰" æŒ‰é’®ï¼Œä¸€æ¬¡æ€§æ›´æ–°æ‰€æœ‰é…ç½®æ•°æ®

## ğŸ’» ä»£ç é›†æˆ

### æ–¹æ³• 1ï¼šä½¿ç”¨ Composableï¼ˆæ¨èï¼‰

```vue
<script setup>
import { onMounted } from 'vue'
import { useProjectConfig } from '@/composables/useProjectConfig'

const {
  teamList,
  pointList,
  loading,
  error,
  fetchTeamList,
  fetchProjectAndPoints
} = useProjectConfig()

onMounted(async () => {
  // è·å–å›¢é˜Ÿåˆ—è¡¨
  await fetchTeamList()
  console.log('å›¢é˜Ÿåˆ—è¡¨:', teamList.value)
  
  // è·å–é¡¹ç›®ç‚¹ä½
  const result = await fetchProjectAndPoints()
  console.log('ç‚¹ä½åˆ—è¡¨:', result.points)
})
</script>

<template>
  <div>
    <div v-for="team in teamList" :key="team.id">
      {{ team.name }}
    </div>
  </div>
</template>
```

### æ–¹æ³• 2ï¼šç›´æ¥ä½¿ç”¨ API

```javascript
import { yeepayAPI } from '@/api'

// è·å–å›¢é˜Ÿåˆ—è¡¨
async function getTeams() {
  try {
    const response = await yeepayAPI.getTeamList()
    console.log('å›¢é˜Ÿåˆ—è¡¨:', response.data)
    return response.data
  } catch (error) {
    console.error('è·å–å¤±è´¥:', error)
  }
}

// è·å–é¡¹ç›®ç‚¹ä½
async function getPoints() {
  try {
    const response = await yeepayAPI.getProjectAndPoints('event1021')
    console.log('ç‚¹ä½åˆ—è¡¨:', response.data)
    return response.data
  } catch (error) {
    console.error('è·å–å¤±è´¥:', error)
  }
}
```

## ğŸ” å¸¸è§åœºæ™¯

### åœºæ™¯ 1ï¼šæŸ¥æ‰¾ç‰¹å®šç‚¹ä½

```javascript
import { useProjectConfig } from '@/composables/useProjectConfig'

const { 
  fetchProjectAndPoints, 
  findPointByName 
} = useProjectConfig()

// åŠ è½½ç‚¹ä½åˆ—è¡¨
await fetchProjectAndPoints()

// æŸ¥æ‰¾ç‰¹å®šç‚¹ä½
const visitPoint = findPointByName('é¡µé¢è®¿é—®åŸ‹ç‚¹')
console.log('æ‰¾åˆ°ç‚¹ä½:', visitPoint)
```

### åœºæ™¯ 2ï¼šè·å–æ‰€æœ‰ç‚¹ä½ID

```javascript
import { useProjectConfig } from '@/composables/useProjectConfig'

const { 
  fetchProjectAndPoints, 
  getAllPointIds 
} = useProjectConfig()

await fetchProjectAndPoints()
const allIds = getAllPointIds()
console.log('æ‰€æœ‰ç‚¹ä½ID:', allIds)
```

### åœºæ™¯ 3ï¼šæœç´¢å’Œè¿‡æ»¤ç‚¹ä½

```vue
<script setup>
import { ref, computed } from 'vue'
import { useProjectConfig } from '@/composables/useProjectConfig'

const { pointList, fetchProjectAndPoints } = useProjectConfig()
const searchText = ref('')

const filteredPoints = computed(() => {
  if (!searchText.value) return pointList.value
  
  return pointList.value.filter(point => {
    const name = point.name || ''
    return name.toLowerCase().includes(searchText.value.toLowerCase())
  })
})

// åŠ è½½æ•°æ®
fetchProjectAndPoints()
</script>

<template>
  <div>
    <input v-model="searchText" placeholder="æœç´¢ç‚¹ä½" />
    <div v-for="point in filteredPoints" :key="point.id">
      {{ point.name }}
    </div>
  </div>
</template>
```

## ğŸ§ª æµ‹è¯•æ¥å£

### æµè§ˆå™¨æ§åˆ¶å°æµ‹è¯•

åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­è¿è¡Œä»¥ä¸‹ä»£ç ï¼š

```javascript
// åŠ è½½æµ‹è¯•è„šæœ¬
const script = document.createElement('script')
script.src = '/doc/test_new_apis.js'
document.head.appendChild(script)

// ç­‰å¾…è„šæœ¬åŠ è½½å®Œæˆåæ‰§è¡Œ
setTimeout(() => {
  // æµ‹è¯•åŸå§‹API
  testNewAPIs()
  
  // æµ‹è¯•Vueé›†æˆAPI
  testWithVueAPI()
}, 1000)
```

### ä½¿ç”¨ curl æµ‹è¯•

```bash
# æµ‹è¯•è·å–å›¢é˜Ÿåˆ—è¡¨
curl 'https://probe.yeepay.com/wfManage/getSimpleTeamList' \
  -H 'access-token: YOUR_TOKEN' \
  -H 'content-type: text/plain;charset=UTF-8' \
  --data-raw '{}'

# æµ‹è¯•è·å–é¡¹ç›®ç‚¹ä½
curl 'https://probe.yeepay.com/tracker/buryPointWarehouse/getProjectAndWeList' \
  -H 'access-token: YOUR_TOKEN' \
  -H 'content-type: text/plain;charset=UTF-8' \
  --data-raw '{"projectId":"event1021"}'
```

## ğŸ“Š æ•°æ®ç»“æ„

### å›¢é˜Ÿåˆ—è¡¨å“åº”æ ¼å¼

```javascript
{
  "code": 0,
  "success": true,
  "data": [
    {
      "id": "team_id_1",
      "name": "å›¢é˜Ÿåç§°",
      "teamName": "å›¢é˜Ÿåç§°",
      // ... å…¶ä»–å­—æ®µ
    }
  ]
}
```

### é¡¹ç›®ç‚¹ä½å“åº”æ ¼å¼

```javascript
{
  "code": 0,
  "success": true,
  "data": {
    "projectInfo": {
      "id": "event1021",
      "name": "é¡¹ç›®åç§°",
      // ... å…¶ä»–å­—æ®µ
    },
    "weList": [
      {
        "id": 110,
        "name": "é¡µé¢è®¿é—®åŸ‹ç‚¹",
        "pointName": "é¡µé¢è®¿é—®åŸ‹ç‚¹",
        "type": "single",
        // ... å…¶ä»–å­—æ®µ
      }
    ]
  }
}
```

## âš™ï¸ é…ç½®è¯´æ˜

### ä¿®æ”¹é¡¹ç›®ID

åœ¨ `src/config/api.js` ä¸­ä¿®æ”¹ï¼š

```javascript
environments: {
  development: {
    projectId: "your_project_id", // ä¿®æ”¹è¿™é‡Œ
    // ...
  }
}
```

### ä¿®æ”¹è®¿é—®ä»¤ç‰Œ

åœ¨ `src/config/api.js` ä¸­ä¿®æ”¹ï¼š

```javascript
environments: {
  development: {
    accessToken: "your_access_token", // ä¿®æ”¹è¿™é‡Œ
    // ...
  }
}
```

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šæ¥å£è¿”å› 401 é”™è¯¯

**åŸå› **ï¼šè®¿é—®ä»¤ç‰Œå¤±æ•ˆæˆ–ä¸æ­£ç¡®

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ `src/config/api.js` ä¸­çš„ `accessToken` é…ç½®
2. æ›´æ–°ä¸ºæœ€æ–°çš„æœ‰æ•ˆä»¤ç‰Œ

### é—®é¢˜ 2ï¼šè¿”å›ç©ºæ•°æ®

**åŸå› **ï¼šé¡¹ç›®IDä¸å­˜åœ¨æˆ–æ²¡æœ‰æƒé™

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤é¡¹ç›®IDæ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥è´¦å·æ˜¯å¦æœ‰è®¿é—®æƒé™

### é—®é¢˜ 3ï¼šè·¨åŸŸé”™è¯¯

**åŸå› **ï¼šå¼€å‘ç¯å¢ƒè·¨åŸŸé™åˆ¶

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ `vite.config.js` ä»£ç†é…ç½®
2. æˆ–åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æµ‹è¯•

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [APIä½¿ç”¨ç¤ºä¾‹](./APIä½¿ç”¨ç¤ºä¾‹.md) - è¯¦ç»†çš„APIä½¿ç”¨è¯´æ˜
- [æ›´æ–°æ—¥å¿—](../CHANGELOG.md) - æŸ¥çœ‹å®Œæ•´çš„æ›´æ–°è®°å½•
- [README](../README.md) - é¡¹ç›®æ€»ä½“è¯´æ˜

## ğŸ’¡ æœ€ä½³å®è·µ

1. **é”™è¯¯å¤„ç†**ï¼šå§‹ç»ˆä½¿ç”¨ try-catch åŒ…è£¹å¼‚æ­¥è°ƒç”¨
2. **åŠ è½½çŠ¶æ€**ï¼šä½¿ç”¨ loading çŠ¶æ€æä¾›ç”¨æˆ·åé¦ˆ
3. **ç¼“å­˜ç®¡ç†**ï¼šé¿å…é¢‘ç¹é‡å¤è¯·æ±‚ç›¸åŒæ•°æ®
4. **ç±»å‹æ£€æŸ¥**ï¼šä½¿ç”¨å¯é€‰é“¾è¿ç®—ç¬¦ `?.` å®‰å…¨è®¿é—®åµŒå¥—å±æ€§

## ğŸ¯ ä¸‹ä¸€æ­¥

- [ ] å°è¯•åœ¨æ§åˆ¶å°æµ‹è¯• API
- [ ] é›†æˆåˆ°ç°æœ‰ç»„ä»¶ä¸­
- [ ] è‡ªå®šä¹‰ç‚¹ä½é€‰æ‹©é€»è¾‘
- [ ] æ·»åŠ æœ¬åœ°ç¼“å­˜ä¼˜åŒ–

---

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ [APIä½¿ç”¨ç¤ºä¾‹](./APIä½¿ç”¨ç¤ºä¾‹.md) æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚

